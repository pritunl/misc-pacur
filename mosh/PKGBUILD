targets=(
    "amazonlinux-2017.12"
    "centos-7"
    "ubuntu-xenial"
)
pkgname="mosh"
pkgver="1.3.2"
pkgrel="1"
pkgdesc="Mobile shell"
pkgdesclong=(
    "Mobile shell, surviving disconnects with local echo and line editing"
)
maintainer="Pritunl Misc <misc@pritunl.com>"
arch="amd64"
license=("GPL3")
section="utils"
priority="optional"
url="https://github.com/mobile-shell/${pkgname}"
depends:yum=(
    "glibc"
    "openssl-libs"
    "libgcc"
    "protobuf"
    "libstdc++"
    "ncurses"
    "ncurses-libs"
    "libutempter"
    "zlib"
    "openssh-clients"
    "openssl"
    "perl"
)
depends:apt=(
    "libc6"
    "libgcc1"
    "libprotobuf9v5"
    "libssl1.0.0"
    "libstdc++6"
    "libtinfo5"
    "libutempter0"
    "openssh-client"
    "zlib1g"
    "libio-socket-ip-perl"
)

makedepends:yum=(
    "openssl-devel"
    "protobuf-devel"
    "ncurses-devel"
    "libutempter-devel"
)
makedepends:apt=(
    "pkg-config"
    "dh-autoreconf"
    "libssl-dev"
    "libprotobuf-dev"
    "libncurses-dev"
    "protobuf-compiler"
    "libutempter-dev"
)
provides=("${pkgname}")
conflicts=(
    "${pkgname}"
)
sources=(
    "${url}/releases/download/${pkgname}-${pkgver}/${pkgname}-${pkgver}.tar.gz"
)
hashsums=(
    "da600573dfa827d88ce114e0fed30210689381bbdcff543c931e4d6a2e851216"
)

build() {
    cd "${srcdir}/${pkgname}-${pkgver}"
    ./autogen.sh
    ./configure --prefix=/usr
    make
}

package() {
    cd "${srcdir}/${pkgname}-${pkgver}"
    make DESTDIR="${pkgdir}" install
}
